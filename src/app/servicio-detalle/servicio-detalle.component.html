<div class="content-wrapper">
  <br class="visible-xs" />
  <br class="visible-xs" />
  <section class="content">
    <div class="row">
      <div class="col-md-6" style="height:300px">
        <div class="box">
          <div class="box-header with-border">
            <h3 class="box-title negritas">Datos del cliente</h3>
          </div>
          <!-- /.box-header -->
          <div class="box-body">
            <div class="col-xs-12">
              <div class="col-xs-12" style="margin-bottom:14px"></div>
              <div class="form-group col-xs-12 col-md-6">
                <label *ngIf="cliente.nombre_comercial !=''">Nombre comercial</label>
                <label *ngIf="cliente.nombre !=''">Nombre</label><br />
                <span *ngIf="cliente.nombre_comercial !=''">{{cliente.nombre_comercial}}</span>
                <span *ngIf="cliente.nombre !=''">{{cliente.nombre}}</span><br /><br />
                <label>Teléfono fijo</label><br />
                <span>{{cliente.telefono}}</span><br /><br />
                <label>Email</label><br />
                <span>{{cliente.email}}</span>
              </div>
              <div class="form-group col-xs-12 col-md-6">
                <label *ngIf="cliente.nombre_comercial !=''">Nombre de contacto</label>
                <label *ngIf="cliente.nombre !=''">Apellidos</label><br />
                <span *ngIf="cliente.nombre_comercial !=''">{{cliente.nombre_contacto}}</span>
                <span *ngIf="cliente.nombre !=''">{{cliente.paterno}} {{cliente.materno}}</span><br /><br />
                <label>Teléfono celular</label><br />
                <span>{{cliente.telefono_movil}}</span><br /><br *ngIf="mostrar_no_cliente" />

                <label *ngIf="mostrar_no_cliente">No. de cliente <button class="pull-center btn-xs btn-default-rojo" (click)="editar_no_cliente(cliente.folio)" *ngxPermissionsOnly="['Contact Center'];">Editar</button></label><br />
                <span *ngIf="mostrar_no_cliente">{{cliente.folio | slice:0:25}}</span>

                <mat-form-field class="full-width" *ngIf="!mostrar_no_cliente">
                  <input matInput type="text" placeholder="Editar número de cliente" id="folio" name="folio" #folio="ngModel" [(ngModel)]="cliente.folio">
                  <button mat-button matSuffix mat-icon-button aria-label="Clear" (click)="editar_cliente()">
                    <mat-icon style="line-height:inherit"><i class="fa fa-pencil" aria-hidden="true" style="line-height:inherit"></i></mat-icon>
                  </button>
                </mat-form-field>
              </div>
              <div class="col-xs-12" style="margin-bottom:12px"></div>
            </div>
          </div>
        </div>
        <!-- /.box -->
      </div>
      <div class="col-md-6" *ngxPermissionsOnly="['Contact Center'];">
        <div class="box">
          <!-- /.box-header -->
          <div class="box-body">
            <div class="col-xs-12">
              <div class="col-xs-12" style="margin-bottom:10px"></div>
              <div class="form-group col-xs-12 col-md-6">
                <button *ngIf="!ir_servicio" type="submit" (click)="validar_servicio();" class="btn btn-default btn-default-rojo col-md-12" style="padding: 40px 30px 40px 30px;">
                  <span style="font-size:20px">Nuevo servicio</span>
                </button>
                <button *ngIf="ir_servicio" [routerLink]="['/nuevoservicio', cliente.id]" type="submit" class="btn btn-default btn-default-rojo col-md-12" style="padding: 40px 30px 40px 30px;">
                  <span style="font-size:20px">Nuevo servicio</span>
                </button>
              </div>
              <div class="form-group col-xs-12 col-md-6">
                <button type="submit" class="btn btn-default btn-default-rojo col-md-12" style="padding: 40px 30px 40px 30px;">
                  <span style="font-size:20px">Venta</span>
                </button>
              </div>
              <div class="form-group col-xs-12 col-md-6">
                <button type="submit" class="btn btn-default btn-default-rojo col-md-12" style="padding: 40px 30px 40px 30px;">
                  <span style="font-size:20px">Quejas</span>
                </button>
              </div>
              <div class="form-group col-xs-12 col-md-6">
                <button type="submit" class="btn btn-default btn-default-rojo col-md-12" style="padding: 40px 30px 40px 30px;">
                  <span style="font-size:20px">Encuesta</span>
                </button>
              </div>
            </div>
          </div>
        </div>
        <!-- /.box -->
      </div>

      <div class="col-md-6">
        <div class="box">
          <div class="box-header with-border">
            <h3 class="box-title negritas">Dirección del cliente</h3>
          </div>
          <!-- /.box-header -->
          <div class="box-body">
            <div class="col-xs-12">
              <div class="col-xs-12" style="margin-bottom:13px"></div>
              <div class="form-group col-xs-12 col-md-6">
                <label>Calle y número</label><br />
                <span>{{direccion.calle_numero}}</span><br /><br />
                <label>Estado</label><br />
                <span>{{direccion.estado}}</span><br /><br />
                <label>Colonia</label><br />
                <span>{{direccion.desc_localidad}}</span>
              </div>
              <div class="form-group col-xs-12 col-md-6">
                <label>CP</label><br />
                <span>{{direccion.cp}}</span><br /><br />
                <label>Delegación / municipio</label><br />
                <span>{{direccion.municipio}}</span><br /><br />
                <label>Referencias</label><br />
                <span>{{ (cliente.referencias.length>50)? (cliente.referencias | slice:0:50)+'..':(cliente.referencias) }}</span><br /><br />
              </div>
            </div>
          </div>
        </div>
        <!-- /.box -->
      </div>

      <div class="col-md-6">
        <div class="box">
          <div class="box-header with-border">
            <h3 class="box-title negritas">Datos fiscales</h3>
          </div>
          <!-- /.box-header -->
          <div class="box-body">
            <div class="col-xs-12">
              <div class="col-xs-12" style="margin-bottom:13px"></div>
              <div class="form-group col-xs-12 col-md-4">
                <label>Razón social</label><br />
                <span>{{datosfiscales.razon_social}}</span><br /><br />
                <label>Estado</label><br />
                <span>{{datosfiscales.estado}}</span><br /><br />
                <label>CP</label><br />
                <span>{{datosfiscales.cp}}</span><br /><br />
              </div>
              <div class="form-group col-xs-12 col-md-4">
                <label>RFC</label><br />
                <span>{{datosfiscales.rfc}}</span><br /><br />
                <label>Delegación / municipio</label><br />
                <span>{{datosfiscales.municipio}}</span><br />
                <label>Email</label><br />
                <span>{{datosfiscales.email}}</span><br /><br />
              </div>

              <div class="form-group col-xs-12 col-md-4">
                <label>Calle y número</label><br />
                <span>{{datosfiscales.calle_numero}}</span><br /><br />
                <label>Colonia</label><br />
                <span>{{datosfiscales.colonia}}</span><br /><br />
              </div>
            </div>
          </div>
        </div>
        <!-- /.box -->
      </div>

      <div class="col-md-12">
        <div class="box">
          <div class="box-header with-border">
            <h3 class="box-title negritas">Productos y servicios</h3>
            <div class="box-tools pull-right">
              <button type="button" class="btn btn-box-tool" data-widget="collapse">
                <i class="fa fa-minus"></i>
              </button>
            </div>
          </div>
          <!-- /.box-header -->
          <div class="box-body">
            <div class="col-xs-12" style="padding:0">
              <mat-tab-group class="demo-tab-group">
                <mat-tab label="EQUIPOS">
                  <div class="demo-tab-content">
                    <form #EquiposForm="ngForm">
                      <div class="example-container mat-elevation-z4">
                        <mat-table #table [dataSource]="dataSource">

                          <!-- Folio Column -->
                          <ng-container matColumnDef="#Servicio">
                            <mat-header-cell *matHeaderCellDef> SKU </mat-header-cell>
                            <mat-cell *matCellDef="let element"> {{element.sku}} </mat-cell>
                          </ng-container>

                          <!-- Position Column -->
                          <ng-container matColumnDef="Modelo">
                            <mat-header-cell *matHeaderCellDef> MODELO </mat-header-cell>
                            <mat-cell *matCellDef="let element"> <span>{{element.modelo}}</span> </mat-cell>
                          </ng-container>

                          <!-- Name Column -->
                          <ng-container matColumnDef="SKU">
                            <mat-header-cell *matHeaderCellDef> NOMBRE </mat-header-cell>
                            <mat-cell *matCellDef="let element"> <span>{{element.nombre}}</span> </mat-cell>
                          </ng-container>

                          <!-- Symbol Column -->
                          <ng-container matColumnDef="Garantia">
                            <mat-header-cell *matHeaderCellDef> GARANTIA </mat-header-cell>
                            <mat-cell *matCellDef="let element"> <span>{{element.garantia}}</span> </mat-cell>
                          </ng-container>

                          <ng-container matColumnDef="Poliza">
                            <mat-header-cell *matHeaderCellDef> POLIZA </mat-header-cell>
                            <mat-cell *matCellDef="let element"> <span>{{element.poliza}}</span> </mat-cell>
                          </ng-container>

                          <ng-container matColumnDef="Estatus">
                            <mat-header-cell *matHeaderCellDef> ESTATUS </mat-header-cell>
                            <mat-cell *matCellDef="let element"><a style="color:inherit; cursor:pointer" title="{{element.estatus}}"><span>{{element.estatus}}</span></a> </mat-cell>
                          </ng-container>

                          <ng-container matColumnDef="Imagen">
                            <mat-header-cell *matHeaderCellDef style=" text-align:center">Troubleshooting</mat-header-cell>
                            <mat-cell *matCellDef="let element" style=" text-align:center"><a style="color:inherit; cursor:pointer" (click)="troubleshooting(element)" *ngxPermissionsOnly="['Contact Center'];"><i class="fa fa-file-text-o" aria-hidden="true"></i></a> </mat-cell>
                          </ng-container>

                          <mat-header-row *matHeaderRowDef="displayedColumns"></mat-header-row>
                          <mat-row *matRowDef="let row; columns: displayedColumns;">
                          </mat-row>
                        </mat-table>
                      </div>
                    </form>

                  </div>
                </mat-tab>
                <!--<mat-tab label="Pólizas de servicio">
                  <ng-template mat-tab-label>
                    Pólizas de servicio
                  </ng-template>
                  <div class="demo-tab-content">
                    <form #EquiposForm="ngForm">
                      <div class="col-xs-12">
                        <div class="form-group col-xs-12 col-md-4">
                          <label>Modelo</label>
                          <input type="text" class="form-control" id="modelo" name="modelo" [(ngModel)]="equipomodelo" #modelo="ngModel" required>
                          <div *ngIf="modelo.invalid && (modelo.dirty || modelo.touched)"
                               class="alert alert-danger">
                            <div *ngIf="modelo.errors.required">
                              Modelo requerido.
                            </div>
                          </div>
                        </div>

                        <div class="form-group col-xs-12 col-md-4">
                          <label>Tipo de producto</label>
                          <select type="text" class="form-control" id="tipoproducto" name="tipoproducto" [(ngModel)]="equipotipo" #tipoproducto="ngModel" required>
                            <option value="1">Tipo 1</option>
                            <option value="2">Tipo 2</option>
                          </select>
                          <div *ngIf="tipoproducto.invalid && (tipoproducto.dirty || tipoproducto.touched)"
                               class="alert alert-danger">
                            <div *ngIf="tipoproducto.errors.required">
                              Tipo de producto requerido.
                            </div>
                          </div>
                        </div>

                        <div class="form-group col-xs-12 col-md-4">
                          <div style="margin-bottom:25px"></div>
                          <button type="button" class="pull-center btn btn-default btn-default-rojo" [disabled]="preventAbuse">
                            {{ preventAbuse ? 'Agregando...' : 'Agregar nuevo producto' }}
                          </button>
                        </div>
                      </div>
                    </form>
                  </div>
                </mat-tab>
                <mat-tab label="Garantías extendidas">
                  <form #EquiposForm="ngForm">
                    <div class="col-xs-12">
                      <div class="form-group col-xs-12 col-md-4">
                        <label>Modelo</label>
                        <input type="text" class="form-control" id="modelo" name="modelo" [(ngModel)]="equipomodelo" #modelo="ngModel" required>
                        <div *ngIf="modelo.invalid && (modelo.dirty || modelo.touched)"
                             class="alert alert-danger">
                          <div *ngIf="modelo.errors.required">
                            Modelo requerido.
                          </div>
                        </div>
                      </div>

                      <div class="form-group col-xs-12 col-md-4">
                        <label>Tipo de producto</label>
                        <select type="text" class="form-control" id="tipoproducto" name="tipoproducto" [(ngModel)]="equipotipo" #tipoproducto="ngModel" required>
                          <option value="1">Tipo 1</option>
                          <option value="2">Tipo 2</option>
                        </select>
                        <div *ngIf="tipoproducto.invalid && (tipoproducto.dirty || tipoproducto.touched)"
                             class="alert alert-danger">
                          <div *ngIf="tipoproducto.errors.required">
                            Tipo de producto requerido.
                          </div>
                        </div>
                      </div>

                      <div class="form-group col-xs-12 col-md-4">
                        <div style="margin-bottom:25px"></div>
                        <button type="button" class="pull-center btn btn-default btn-default-rojo" [disabled]="preventAbuse">
                          {{ preventAbuse ? 'Agregando...' : 'Agregar nuevo producto' }}
                        </button>
                      </div>
                    </div>
                  </form>
                </mat-tab>
                <mat-tab label="Home program">
                  <form #EquiposForm="ngForm">
                    <div class="col-xs-12">
                      <div class="form-group col-xs-12 col-md-4">
                        <label>Modelo</label>
                        <input type="text" class="form-control" id="modelo" name="modelo" [(ngModel)]="equipomodelo" #modelo="ngModel" required>
                        <div *ngIf="modelo.invalid && (modelo.dirty || modelo.touched)"
                             class="alert alert-danger">
                          <div *ngIf="modelo.errors.required">
                            Modelo requerido.
                          </div>
                        </div>
                      </div>

                      <div class="form-group col-xs-12 col-md-4">
                        <label>Tipo de producto</label>
                        <select type="text" class="form-control" id="tipoproducto" name="tipoproducto" [(ngModel)]="equipotipo" #tipoproducto="ngModel" required>
                          <option value="1">Tipo 1</option>
                          <option value="2">Tipo 2</option>
                        </select>
                        <div *ngIf="tipoproducto.invalid && (tipoproducto.dirty || tipoproducto.touched)"
                             class="alert alert-danger">
                          <div *ngIf="tipoproducto.errors.required">
                            Tipo de producto requerido.
                          </div>
                        </div>
                      </div>

                      <div class="form-group col-xs-12 col-md-4">
                        <div style="margin-bottom:25px"></div>
                        <button type="button" class="pull-center btn btn-default btn-default-rojo" [disabled]="preventAbuse" *ngxPermissionsOnly="['Contact Center'];">
                          {{ preventAbuse ? 'Agregando...' : 'Agregar nuevo producto' }}
                        </button>
                      </div>
                    </div>
                  </form>
                </mat-tab>-->
              </mat-tab-group>
            </div>
          </div>

        </div>
        <!-- /.box -->
      </div>

      <div class="col-md-12">
        <div class="box">
          <!-- /.box-header -->
          <div class="box-body">
            <div class="col-xs-12" style="padding-bottom:15px">
              <label>Editar dirección</label>
              <mat-divider></mat-divider>
              <br />
              <form #registroForm="ngForm">
                <div class="form-group col-xs-12 col-md-4" style="padding-left:0">
                  <mat-form-field class="full-width">
                    <input matInput id="calle_numero" type="text" name="calle_numero" #calle_numero="ngModel" [(ngModel)]="direccion.calle_numero" placeholder="Calle y número">
                  </mat-form-field>
                </div>

                <div class="form-group col-xs-12 col-md-4">
                  <mat-form-field class="full-width">
                    <input matInput id="cp" type="text" name="cp" #cp="ngModel" [(ngModel)]="direccion.cp" placeholder="C.P">
                  </mat-form-field>
                </div>

                <div class="form-group col-xs-12 col-md-4" style="padding-right:0">
                  <mat-form-field class="full-width">
                    <mat-select placeholder="Estado" id="estado" name="estado" #estado="ngModel" [(ngModel)]="direccion.id_estado" (change)="getmunicipios()">
                      <mat-option *ngFor="let value of estados; trackBy: index;" [value]="value.id">
                        {{value.desc_estado}}
                      </mat-option>
                    </mat-select>
                  </mat-form-field>
                </div>

                <div class="form-group col-xs-12 col-md-4" style="padding-left:0">
                  <mat-form-field class="full-width">
                    <mat-select placeholder="Delegación / Municipio" id="municipio" name="municipio" #municipio="ngModel" [(ngModel)]="direccion.id_municipio">
                      <mat-option *ngFor="let value of municipios; trackBy: index;" [value]="value.id">
                        {{value.municipio}}
                      </mat-option>
                    </mat-select>
                  </mat-form-field>
                </div>

                <div class="form-group col-xs-12 col-md-4">
                  <mat-form-field class="full-width">
                    <mat-select placeholder="Colonia" id="colonia" name="colonia" #colonia="ngModel" [(ngModel)]="direccion.colonia" required>
                      <mat-option *ngFor="let value of localidades; trackBy: index;" [value]="value.id_localidad">
                        {{value.localidad | uppercase}}
                      </mat-option>
                    </mat-select>
                    <mat-error *ngIf="colonia.dirty || colonia.pristine">
                      Colonia es <strong>requerido</strong>
                    </mat-error>
                  </mat-form-field>

                  <!--<mat-form-field class="full-width">
                    <input matInput id="colonia" type="text" name="colonia" #colonia="ngModel" [(ngModel)]="direccion.colonia" placeholder="Cólonia">
                  </mat-form-field>-->
                </div>

                <div class="form-group col-xs-12 col-md-4" style="padding-right:0;">
                  <mat-form-field class="full-width">
                    <input matInput [textMask]="{mask: mask_telefono, guide: false}" id="telefono" type="text" name="telefono" #telefono="ngModel" [(ngModel)]="cliente.telefono" placeholder="Télefono">
                  </mat-form-field>
                </div>

                <div class="col-xs-12 text-right" style="padding:0;" *ngxPermissionsOnly="['Contact Center'];">
                  <button type="submit" class="pull-center btn btn-default btn-default-rojo" (click)="editar_direccion(direccion.id_direccion);">Guardar</button>
                </div>
              </form>

            </div>
          </div>

        </div>
        <!-- /.box -->
      </div>

      <div class="col-md-12">
        <div class="box">
          <div class="box-header with-border">
            <h3 class="box-title negritas">Historial de servicio</h3>
            <div class="box-tools pull-right">
              <button type="button" class="btn btn-box-tool" data-widget="collapse">
                <i class="fa fa-minus"></i>
              </button>
            </div>
          </div>
          <!-- /.box-header -->
          <div class="box-body">
            <div class="col-xs-12" style="padding:0">
              <form #HistorialForm="ngForm">
                <div class="col-xs-12">
                  <div class="example-container mat-elevation-z4">
                    <mat-table #table [dataSource]="dataSource_Historial">

                      <!-- Folio Column -->
                      <ng-container matColumnDef="#Servicio">
                        <mat-header-cell *matHeaderCellDef> NO. SERVICIO </mat-header-cell>
                        <mat-cell *matCellDef="let element"> {{element.id_servicio}} </mat-cell>
                      </ng-container>

                      <!-- Position Column -->
                      <ng-container matColumnDef="Fecha">
                        <mat-header-cell *matHeaderCellDef> FECHA DE SERVICIO </mat-header-cell>
                        <mat-cell *matCellDef="let element"> <span>{{element.fecha_servicio}}</span> </mat-cell>
                      </ng-container>

                      <!-- Name Column -->
                      <ng-container matColumnDef="Estatus">
                        <mat-header-cell *matHeaderCellDef> Estatus </mat-header-cell>
                        <mat-cell *matCellDef="let element"> <span>{{element.desc_estatus_servicio}}</span> </mat-cell>
                      </ng-container>

                      <mat-header-row *matHeaderRowDef="displayedColumnsHistorial"></mat-header-row>
                      <mat-row *matRowDef="let row; columns: displayedColumnsHistorial;">
                      </mat-row>
                    </mat-table>
                  </div>
                </div>
              </form>
            </div>
          </div>

        </div>
        <!-- /.box -->
      </div>
      <!-- /.col -->
    </div>
  </section>
  <!-- /.content -->
</div>
